SQL-SERVER

### ⓵Key的種類

##### ．主鍵 (Primary Key 主索引鍵)

特性：唯一性

表示方式：資料表中會在主鍵的詞前加上*作為標記

說明：非重複性的資料類別可作為主鍵的類別，主鍵的欄位可為一個或是多個欄位所組成，

但是一個資料表中只會有一個類別作為主鍵。

##### ．連外鍵 (Foreign Key 外部索引鍵)

說明：一個資料表中只會有一個主鍵類別，但在一個資料表中可以有多個連外鍵。

舉例：

下圖用書籍編號如：A表中的B0001作為連外鍵代替書籍名稱，則A表的B0001會去尋找B表的B0001，而B表的B0001為B資料表中的主鍵。

所以圖示會像： A表連外鍵-----尋找----->B表主鍵

<img src="https://cdn.discordapp.com/attachments/1293405178409779201/1293408762538885212/20241009_110422.jpg?ex=6719b947&is=671867c7&hm=8eb40685b1ec7864e209d3d6016f2b494ed41b37eb739fe0e204601b7376eea2&" title="" alt="" width="627">

========================================

### ⓶關聯式資料庫

特色：資料完整性

###### 一、實體完整性：

        特性：確保資料表中的記錄是唯一

        說明：設定主鍵就是為了達成實體完整性，如果主鍵的資料重複就不符合實體完整性。

###### 二、區域完整性：

        特色：在允許範圍中

        舉例：如限制數值欄位的範圍為0~999，而資料表中填入的數值欄位為1000時，就不府和區域完整性。

###### 三、參考完整性：

        特色：確保相關資料表間的資料一致

        舉例：A表中的FF003去尋找其他資料表中的FF003，結果尋找不到FF003，就不符合參考完整性。

###### 四、使用者定義的完整性：

        特色：使用者自行定義

=========================================

### ⓷不同的關聯性

##### 壹、 一對一關聯

**說明：**

            甲一筆資料 ----對應到---> 乙一筆資料

![](https://cdn.discordapp.com/attachments/1293405178409779201/1293414242543865926/1293413909985886260remix-1728444382448.png?ex=6722f8e1&is=6721a761&hm=b02eb2cad50fa757e3c63afd751fd37ea143ff104ce33cd198b13f62afc74dc6&=)

##### 貳、一對多關聯

**說明：**

            甲一筆資料 ---對應到---> 乙多筆資料

![](https://cdn.discordapp.com/attachments/1293405178409779201/1293414718219747358/20241009_112730.jpg?ex=6722f953&is=6721a7d3&hm=22ee534bdee4c0d00236ce6b9c4e9af26b8decd455302ac337fcd94d6c4907f4&=)

##### 參、多對多關聯

**說明：**

            甲一筆資料 ---對應到---> 乙多筆資料，乙一筆資料 ---對應到---> 甲多筆資料

![](https://cdn.discordapp.com/attachments/1293405178409779201/1293415889064169563/20241009_113244.jpg?ex=6722fa6a&is=6721a8ea&hm=f2f5da99ecd2f7cfa415558e8c87547561aad97fc50055c306d5c764c1ceb3c1&=)

======================================

### ⓸ 實體關係模型

橢圓形：實體屬性

菱形：實體與實體之間的關係

方形：實體

![](C:\Users\88697\AppData\Roaming\marktext\images\2024-10-30-13-33-29-image.png)

#### 。 實體(Entity)

**說明：** 可從真實世界的資料中識別出來的東西。

**舉例：** 人、客戶、產品、地方、物件、事件、一個觀念。

#### 。 實體集合

**說明：** 在實體關係模型中，會將同一類型的實體集合起來成為<mark>實體集合</mark>，具有<mark>相同的特性</mark>

**舉例：** Randy 、Admads、George都是學生都是相同類型的實體，集合起來成為實體集合，因為都具有相同特性有：學號、姓名、性別....等

#### 。實體類型、實例

**說明：** 為了明確的區別每一個實體集合，依照特性不同，給予識別名稱。

**舉例：** Randy 、Admads、George都為學生，而<mark>學生</mark>就是<mark>實體類型</mark>，而Randy 、Admads、George{<mark>姓名</mark>}是學生實體類型中的<mark>實例</mark>。

==========================================

### ⓹弱實體、一般實體

##### 弱實體

**說明：** 必須依靠其他實體才能存在。

**舉例：** 學校的學生為一個實體，而<mark>學生家長為弱實體</mark>。必須依靠學生實體才能存在，如果學生從學校畢業後，該學生的家長就孜然的刪除了。

![](C:\Users\88697\AppData\Roaming\marktext\images\2024-10-30-14-05-20-image.png)

##### 一般實體

**說明：** 除了弱實體外其他都是一般實體。

**舉例：** 學生、書籍。

================================================

### ⓺屬性Attribute

###### 一、鍵屬性

**說明：** 可做唯一識別該實體的實例，要畫底線。

**舉例：** 學號作為識別學生的實例。

<u>弱實體中鍵屬性虛底線</u>

###### 二、推導屬性

**說明：** 某些屬性可以由其他屬性而推算出來，以虛線的橢圓形表示。

###### 三、複合屬性

**說明：** 有些屬性可以再攜分為多個小屬性。

**舉例：** 地址可以分開、姓氏名字分開。

###### 四、多值屬性

**舉例：** 專長不只有一個。

====================================================

#### ⓻實體-關係圖

實體都用資料表示屬性、欄位

鍵屬性=>主鍵

複合屬性中，所有屬性轉為資料表中、欄位

#### **弱實體的轉換**

    弱實體的存在需依附在其他實體才能存活。

    弱實體需依賴實體的鍵屬性加入作為連外鍵。

<img src="https://cdn.discordapp.com/attachments/1293405178409779201/1298474563796996106/image.png?ex=6729842c&is=672832ac&hm=de4129db6f6e5d311a91f5929f34a2ff1dbe0f129c137f8316459562699e7e9a&=" title="" alt="" width="341">

#### 多值屬性的轉換

    實體中的屬性為多值屬性需為該屬性另外建立資料表    ![](https://cdn.discordapp.com/attachments/1293405178409779201/1298475218750148699/image.png?ex=672984c8&is=67283348&hm=a9e06d0bd3ecf3edae2f29d6f02bb8f0ae5d0d90720c0065ec39603923357073&=)

#### 「一對一」關係的轉換

將部分參與實體的主鍵放入部參與的實體中做為連外鍵

舉例：公司為了獎勵員工給予每位員工汽車，在這中員工是全部參與，汽車是部分參與，會多買汽車當作備案，如果車壞了可以馬上更換。

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298476637150642236/image.png?ex=6729861a&is=6728349a&hm=f13c6c06f66a574cf2959ff1d4c24f9463ad8648f20ef1241940f1ce7222ab8f&=)

#### 「一對多」的轉換

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298478060370264114/image.png?ex=6729876e&is=672835ee&hm=a6a776bb5ceca1f4ae946035757ffd6da1066de040a70a5eeb49813542db8e3e&=)

#### 「多對多」關係轉換

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298478335768395857/image.png?ex=672987af&is=6728362f&hm=545c512d113a830aea3e41fe109ecc45759422931eaa4604e3fa13b0466b0672&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298479152558768140/2024-10-23_105014.png?ex=67298872&is=672836f2&hm=6a551daa0e31859d294f450478c528309959d201f945af62a856908495ff4496&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298479985849536512/image.png?ex=672adab9&is=67298939&hm=7d53e18188b215539571aad7624cdaa3df76a06ac5800dc418da3edcc7b9c67f&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298480144763060316/image.png?ex=672adadf&is=6729895f&hm=9ba1ab66a07f595fe0eeedff58e51d47e01ebcd6730705a86fdc47246bc2136f&=)

客戶 =>客戶編號 主鍵 copy to 訂單 =>客戶編號  連外鍵

=============================================================

#### ⓼ 資料庫正規化

1、不當設計所造成的異動操作

**處理**做出適當切割後，可方便查詢且不容易出錯

***正規化 * 可為資料完整性、隱私性、容易維護 、資料不易重複、查詢容易**

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298488428911923290/image.png?ex=672ae296&is=67299116&hm=68387f1abb8a33280dd42ba92b3efe3ccefa9cb095ac037664d1e42fd5ba19ba&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298488500357959781/image.png?ex=672ae2a7&is=67299127&hm=c4eefa86791925098de79556aa604675edf7298d478fb7303eb3c02a7422f56b&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298488549439574047/image.png?ex=672ae2b2&is=67299132&hm=a9a2d291b2aca27c6ad8a2e352c7eac71c1ce4c185662de7590cd50eaced1abc&=)



![](https://cdn.discordapp.com/attachments/1293405178409779201/1298493812368474162/image.png?ex=672c3919&is=672ae799&hm=3ae04f0c6e640e242cfcf5e509875b676353d0b0b0e019fbf55d0354c473bc7f&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298495920446505023/image.png?ex=672c3b10&is=672ae990&hm=61bc0550d75934d93824a574489f91b984ff984a0d9e7a83e02cad0289ae3346&=)

相依性 ：產品編號 =>產品名稱 

相依性：供應商編號+產品編號 => 單價

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298497497236242515/image.png?ex=672c3c88&is=672aeb08&hm=eb9f366582515c6b97f8c484bc344f8d1de229166201af4cc22b4c7481472ec9&=)

![](https://cdn.discordapp.com/attachments/1293405178409779201/1298498062452523069/image.png?ex=672c3d0f&is=672aeb8f&hm=8e5d260fee2dfdbd52297c62460c729c4711243961ecc7ddd723ba0969b7c682&=)

=======================================================================

### **SQL Server的相關資料庫**

系統資料庫：系統層級 

AdventureWorks：範例 

ReportServer：報表服務 

使用者自建資料庫：CHXX範例資料庫 

master： 系統層級、核心 =======================================================================**<mark>msdb：</mark>**

**功能：**

讓SQL Server Agent 服務使用，讓代理程式，記錄：排程警告、排程作業、其他相關作業

SQL Server Agent 執行排程管理工作
核心資料庫，如果資料庫損毀、SQL Server將無法正常啟動
記錄：登入帳號、被管理的端點server、分散式處理的server，以及SQL Server 系統中所有的設定項目。
master資料庫記錄所有SQL Server所有的資料庫資訊，包含資料庫的實體檔案位置、SQL Server初始資訊
<mark>Model：</mark>

目的：當成所有新建資料所參考的一個樣版資料庫
so新增一個資料庫時系統會參考此model資料庫。

<mark>tempdb :</mark>

全域性、暫時性儲存資料，
使用者在經過龐大資料計算時暫時儲存的一個資源
暫存性，如果系統重新啟動之後，全部被清除掉
